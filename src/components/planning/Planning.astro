---
import type { Code, Debug } from "astro:components";
import shows from "../../data/shows.json";
import {
  getShowsByDate,
  getSortedShowsByDate,
  formatDate,
  getShowsByPlatform,
} from "../../scripts/utils";
import GroupByDate from "./GroupByDate.astro";

const showsByDate = getShowsByDate(shows);
const sortedShowsByDate = getSortedShowsByDate(showsByDate);
// console.log(sortedShowsByDate.slice(5));
// console.log(getShowsByPlatform(sortedShowsByDate[2].shows));

const computedShows = sortedShowsByDate.map((group) => {
  const showsByPlatform = getShowsByPlatform(group.shows);

  return {
    date: group.date,
    shows: showsByPlatform,
  };
});

console.log(computedShows[0]);
---

<section id="planning">
  <h2 class="font-bold text-2xl sm:text-4xl my-4 border-b-4 sm:border-b-8 border-notionyellow-500 inline">Planning</h2>
  <!-- {
    sortedShowsByDate.map((group) => (
      <div class="my-4">
        <h3 class="font-bold text-xl mb-2">{formatDate(group.date)}</h3>
        <div>{group.shows.map((show) => (
            <p class="my-1"><span class="font-bold">{show.Titre}</span> - {show.Saison} - {show.Plateforme}{show.Note !== "" ? ` - ${show.Note}` : ""}</p>
            ))}</div>
      </div>
    ))
  } -->
  {
    // computedShows.map((dateGroup) => (
    //   <div class="my-8 sm:my-12">
    //     <time class="font-bold text-lg sm:text-xl mb-2">{formatDate(dateGroup.date)}</time>
    //     <div>
    //       {dateGroup.platformGroup.map((platform) => (
    //         <div class="my-6">
    //           <h3 class="inline bg-notiongray-100 text-textplatform-900 sm:text-lg rounded py-1 px-2 mb-2">{platform.platform}</h3>
    //           <div class="ml-8">
    //             {platform.shows.map((show) => (
    //               <div class="max-w-3xl text-sm sm:text-base rounded p-2 my-1">
    //                 <div class="flex gap-3 flex-wrap">
    //                   {show.Heure === "00:00:00" ? "" : <time class="font-semibold  text-notionyellow-500">{show.Heure.slice(0,5)}</time>}
    //                   <div class="font-semibold">{show.Titre}</div>
    //                   <div class="flex gap-2 items-center">
    //                     <div class="">{show.Saison}</div>
    //                     <div class="font-medium border border-solid border-gray-200 px-1 text-xs sm:text-sm">{show.Pays}</div>
    //                   </div>
    //                 </div>
    //                   {show.Note !== "" ? (<hr class="my-1"><span class="italic text-right">{show.Note}</span>) : ""}
    //               </div>
    //             ))}
    //           </div>
    //         </div>
    //       ))}
    //     </div>
    //   </div>
    // ))
    computedShows.map((dateGroup) => (
      <GroupByDate {...dateGroup} />
    ))
  }
</section>
